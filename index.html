<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tropa do Cano Demon List</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
        header { background-color: #333; color: white; text-align: center; padding: 20px 0; }
        #demon-list, #submit-completion, #leaderboard, #moderation, #completions { padding: 20px; margin: 20px; background-color: white; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px; text-align: center; border: 1px solid #ddd; }
        th { background-color: #333; color: white; }
        input, button { padding: 8px; margin: 10px 5px; border-radius: 4px; border: 1px solid #ccc; }
        button { background-color: #333; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #555; }
        .pending { background-color: #f1c40f; }
        .confirmed { background-color: #2ecc71; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); justify-content: center; align-items: center; }
        .modal-content { background-color: white; padding: 20px; border-radius: 8px; width: 80%; max-width: 800px; }
        #profile-modal { width: 60%; }
    </style>
</head>
<body>
    <header>
        <h1>Tropa do Cano Demon List</h1>
        <p>Os mais difíceis e épicos níveis do Geometry Dash!</p>
    </header>

    <section id="demon-list">
        <h2>Lista de Níveis Demon</h2>
        <table id="demon-table">
            <thead>
                <tr>
                    <th>Posição</th>
                    <th>Nome do Nível</th>
                    <th>Pontos</th>
                    <th>Submeter Completion</th>
                </tr>
            </thead>
            <tbody>
                <!-- Demon list will be dynamically populated -->
            </tbody>
        </table>
    </section>
    
    <section id="submit-completion">
        <h2>Submeter Completion</h2>
        <form id="completion-form">
            <input type="text" id="player-name" placeholder="Seu Nome" required>
            <input type="text" id="level-name" placeholder="Nome do Nível" required>
            <input type="url" id="youtube-link" placeholder="Link do YouTube (prova)" required>
            <input type="text" id="device" placeholder="Dispositivo (PC/Mobile)" required>
            <button type="submit">Submeter</button>
        </form>
    </section>
    
    <section id="moderation">
        <h2>Moderação</h2>
        <p>Moderadores podem confirmar ou rejeitar as submissões de completion aqui:</p>
        <table id="moderation-table">
            <thead>
                <tr>
                    <th>Nome do Nível</th>
                    <th>Nome do Jogador</th>
                    <th>Link do YouTube</th>
                    <th>Dispositivo</th>
                    <th>Status</th>
                    <th>Ação</th>
                </tr>
            </thead>
            <tbody>
                <!-- Pendentes de moderação -->
            </tbody>
        </table>
    </section>
    
    <section id="leaderboard">
        <h2>Leaderboard</h2>
        <ol id="leaderboard-list">
            <!-- Leaderboard will be dynamically populated -->
        </ol>
    </section>
    
    <section id="profile-modal" class="modal">
        <div class="modal-content">
            <h2>Perfil do Jogador</h2>
            <p id="player-info"></p>
            <h3>Completions</h3>
            <ul id="player-completions-list">
                <!-- Completions do jogador -->
            </ul>
            <h3>Nível Mais Difícil Completado</h3>
            <p id="most-difficult-level"></p>
            <button onclick="closeProfile()">Fechar</button>
        </div>
    </section>

    <script>
        // Lista de níveis demon
        let demonLevels = [
            { nome: "The Hell Factory", pontos: 100, completions: [] },
            { nome: "Theory of Everything 2", pontos: 90, completions: [] },
            { nome: "Deadlocked", pontos: 80, completions: [] },
            { nome: "Electrodynamix", pontos: 70, completions: [] },
            { nome: "Clubstep", pontos: 60, completions: [] }
        ];

        // Lista de jogadores e suas completions
        let players = [];

        // Função para popular a lista de níveis demon
        function populateDemonList() {
            const table = document.getElementById("demon-table").getElementsByTagName("tbody")[0];
            table.innerHTML = "";
            demonLevels.forEach((level, index) => {
                let row = table.insertRow();
                row.insertCell(0).innerText = index + 1;
                row.insertCell(1).innerText = level.nome;
                row.insertCell(2).innerText = level.pontos;
                let submitCell = row.insertCell(3);
                let submitButton = document.createElement("button");
                submitButton.innerText = "Submeter";
                submitButton.onclick = function () {
                    openLevelCompletions(level);
                };
                submitCell.appendChild(submitButton);
            });
        }

        // Função para submeter completion
        function submitCompletion(event) {
            event.preventDefault();
            const playerName = document.getElementById("player-name").value;
            const levelName = document.getElementById("level-name").value;
            const youtubeLink = document.getElementById("youtube-link").value;
            const device = document.getElementById("device").value;

            let level = demonLevels.find(l => l.nome === levelName);
            if (level) {
                const pendingCompletion = {
                    playerName,
                    youtubeLink,
                    device,
                    levelName,
                    pontos: level.pontos,
                    status: 'pendente'
                };

                // Verificar se o jogador já existe
                let player = players.find(p => p.name === playerName);
                if (!player) {
                    player = { name: playerName, completions: [] };
                    players.push(player);
                }

                // Adicionar a completion ao jogador
                player.completions.push(pendingCompletion);

                alert("Completion submetido com sucesso! Aguardando aprovação.");
                populateDemonList();
                populateModeration();
                updateLeaderboard();
            }
        }

        // Função para popular a tabela de moderação
        function populateModeration() {
            const table = document.getElementById("moderation-table").getElementsByTagName("tbody")[0];
            table.innerHTML = "";
            players.forEach(player => {
                player.completions.forEach(completion => {
                    if (completion.status === 'pendente') {
                        let row = table.insertRow();
                        row.insertCell(0).innerText = completion.levelName;
                        row.insertCell(1).innerText = completion.playerName;
                        row.insertCell(2).innerHTML = `<a href="${completion.youtubeLink}" target="_blank">Link</a>`;
                        row.insertCell(3).innerText = completion.device;
                        row.insertCell(4).innerText = completion.status;
                        let actionCell = row.insertCell(5);
                        let acceptButton = document.createElement("button");
                        acceptButton.innerText = "Aceitar";
                        acceptButton.onclick = function () {
                            acceptCompletion(completion);
                        };
                        actionCell.appendChild(acceptButton);
                    }
                });
            });
        }

        // Função para aceitar a submission
        function acceptCompletion(completion) {
            completion.status = 'confirmado';
            populateModeration();

            // Mover a completion para o nível correspondente
            let level = demonLevels.find(l => l.nome === completion.levelName);
            if (level) {
                level.completions.push(completion);
                updateLeaderboard();
            }
        }

        // Função para atualizar a leaderboard
        function updateLeaderboard() {
            const leaderboard = document.getElementById("leaderboard-list");
            leaderboard.innerHTML = "";
            players.forEach(player => {
                let totalPoints = player.completions.reduce((sum, completion) => sum + demonLevels.find(level => level.nome === completion.levelName).pontos, 0);
                let leaderboardEntry = document.createElement("li");
                leaderboardEntry.innerText = `${player.name} - ${totalPoints} pontos`;
                leaderboardEntry.onclick = function () {
                    showPlayerProfile(player);
                };
                leaderboard.appendChild(leaderboardEntry);
            });
        }

        // Função para mostrar o perfil do jogador
        function showPlayerProfile(player) {
            const profileModal = document.getElementById("profile-modal");
            const playerInfo = document.getElementById("player-info");
            const playerCompletionsList = document.getElementById("player-completions-list");
            const mostDifficultLevel = document.getElementById("most-difficult-level");

            playerInfo.innerText = `Nome: ${player.name}`;
            playerCompletionsList.innerHTML = "";
            let maxPoints = 0;
            let hardestLevel = "";
            player.completions.forEach(completion => {
                let listItem = document.createElement("li");
                listItem.innerText = completion.levelName;
                playerCompletionsList.appendChild(listItem);

                if (completion.pontos > maxPoints) {
                    maxPoints = completion.pontos;
                    hardestLevel = completion.levelName;
                }
            });
            mostDifficultLevel.innerText = hardestLevel;
            profileModal.style.display = "flex";
        }

        // Função para fechar o perfil
        function closeProfile() {
            const profileModal = document.getElementById("profile-modal");
            profileModal.style.display = "none";
        }

        // Inicializar
        document.getElementById("completion-form").addEventListener("submit", submitCompletion);
        populateDemonList();
        populateModeration();
        updateLeaderboard();
    </script>
</body>
</html>
